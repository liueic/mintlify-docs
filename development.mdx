---
title: '开发指南'
description: '在本地环境进行AI Gateway开发和调试'
---

<Info>
  **前置要求**:
  - Python 3.12+
  - uv包管理器
  - 至少一个AI平台的API密钥
</Info>

## 环境准备

### 安装uv

uv是一个快速的Python包管理器，推荐用于AI Gateway开发：

```bash
# 安装uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# 验证安装
uv --version
```

### 克隆项目

```bash
git clone https://github.com/your-repo/ai-gateway.git
cd ai-gateway
```

## 本地开发

### 1. 安装依赖

使用uv安装项目依赖：

```bash
# 创建虚拟环境并安装依赖
uv sync

# 激活虚拟环境
source .venv/bin/activate  # Linux/macOS
# 或
.venv\Scripts\activate     # Windows
```

### 2. 配置环境变量

参考[快速开始](/quickstart)页面中的环境变量配置部分，创建 `.env` 文件并配置必要的API密钥。

### 3. 启动开发服务器

```bash
# 启动开发服务器
uv run uvicorn main:app --host 0.0.0.0 --port 3000 --reload
```

<Check>
开发服务器启动后，访问 http://localhost:3000 查看API文档
</Check>

## 开发工具

### 代码格式化

AI Gateway 使用black和isort进行代码格式化：

```bash
# 格式化代码
uv run black .
uv run isort .

# 检查代码格式
uv run black --check .
uv run isort --check-only .
```

### 类型检查

使用mypy进行类型检查：

```bash
# 运行类型检查
uv run mypy .
```

### 测试

运行项目测试：

```bash
# 运行所有测试
uv run pytest

# 运行特定测试文件
uv run pytest tests/test_fastgpt_agent.py

# 生成测试覆盖率报告
uv run pytest --cov=app tests/
```

## 调试技巧

### 日志配置

在开发环境中，可以设置更详细的日志级别：

```bash
# 设置日志级别
export LOG_LEVEL=DEBUG

# 启动服务
uv run uvicorn main:app --reload --log-level debug
```

### 调试模式

使用Python调试器进行调试：

```python
import pdb; pdb.set_trace()  # 在代码中添加断点
```

或者使用VSCode的调试功能：

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "AI Gateway Debug",
      "type": "python",
      "request": "launch",
      "program": "${workspaceFolder}/main.py",
      "env": {
        "PYTHONPATH": "${workspaceFolder}"
      }
    }
  ]
}
```

## 开发新Agent

要开发新的AI平台支持，请参考[Agent开发指南](/essentials/agent-development)页面。

## 文档开发

### 本地预览文档

AI Gateway 使用Mintlify进行文档管理。要预览文档：

```bash
# 安装Mintlify CLI
npm i -g mint

# 启动文档预览
mint dev
```

文档将在 http://localhost:3000 上可用。

### 自定义端口

如果3000端口被占用，可以使用其他端口：

```bash
mint dev --port 3333
```

## 常见问题

<AccordionGroup>
<Accordion title="依赖安装失败">
检查Python版本是否为3.12+，确保网络连接正常。
</Accordion>

<Accordion title="API调用失败">
确认环境变量配置正确，API密钥有效。
</Accordion>

<Accordion title="端口被占用">
使用其他端口启动服务：`uv run uvicorn main:app --port 3001 --reload`
</Accordion>
</AccordionGroup>

## 下一步

<CardGroup cols={2}>
<Card title="Agent开发" icon="code" href="/essentials/agent-development">
  学习如何为AI Gateway添加新的AI平台支持
</Card>

<Card title="API文档" icon="terminal" href="/api-reference/introduction">
  查看完整的API接口文档
</Card>

<Card title="部署指南" icon="rocket" href="/deploy">
  了解如何部署AI Gateway到生产环境
</Card>

<Card title="架构设计" icon="diagram-project" href="/essentials/architecture">
  深入了解AI Gateway的技术架构
</Card>
</CardGroup>
